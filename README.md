# OptiCIF

OptiCIF is a Python package for performing global optimization on [CIF](https://eclipse.dev/escet/cif/) specifications
by reordering explicit plant automaton declarations according to a provided input sequence. Global optimization is
formally defined in
Reijnen ([2020](https://www.persistent-identifier.nl/urn:nbn:nl:ui:25-115168de-878f-4f5f-9c55-126f20f845fe)). It
integrates in
the [synthesis-based engineering](https://www.eclipse.org/escet/cif/synthesis-based-engineering/approaches/synthesis-based-engineering.html)
development process. This package was developed as part of a bachelor thesis at the Eindhoven University of Technology.

Modules:

- `csv_utils`: Utility functions for working with CSV files, including:
    - converting a list of sequenced RaGraph node objects to a CSV file;
    - converting a binary DSM matrix in .mat to an edge list in CSV format, using node names from a separate CSV file;
    - generating CSV files with ordered node and plant group names based on a product system map and a group
      sequence. It also labels each item in the CSV files with the iteration block it is part of.
- `validators`: Functions for validating the structure of CSV files containing node sequences and binary DSM matrices.
- `cif_transformer`: Function for performing global optimization by reordering explicit plant automaton declarations.

## Installation

To use OptiCIF, clone the repository:
Including an example of the output in the README can be helpful to users. It gives them an idea of what to expect after
running the code, and it can also serve as a form of validation for them to check if the code ran correctly. This is
especially important if the output is complex or not immediately intuitive.

In the case of your project, since the output is a reordered CIF file based on the node sequence from a CSV file, you
could include a snippet of the reordered CIF specification in the README. However, keep in mind that showing the entire
file may not be practical if it's too large. A snippet with a brief explanation should suffice.

Here's an example of how you can present it:

```bash
git clone https://github.com/jdelagedavies/opticif.git
```

The project is managed using Poetry. Ensure that you
have [Poetry installed](https://python-poetry.org/docs/#installation) and then install the dependencies:

```bash
cd opticif
poetry install
```

Alternatively, install the dependencies manually. You can find the list of dependencies in the `pyproject.toml file`,
under the `[tool.poetry.dependencies]` section.

## Usage

OptiCIF can be used as a standalone tool for global optimization on CIF specifications. It also offers seamless
integration with input sequences generated by the [RaGraph package](https://ragraph.ratio-case.nl/) and the MATLAB
sequencing script developed by de
Jong ([2019](https://research.tue.nl/en/studentTheses/9bcf3b6d-18e5-4c3e-8c89-2e9ebe64dec0)).

Here's a basic example of using OptiCIF to perform global optimization on a CIF specification:

```python
from opticif import do_global_optimization

# Define input files
cif_path = "path/to/your/cif/specification.cif" # CIF file containing the plant model
csv_path = "path/to/your/sequence.csv"  # CSV file containing the node sequence

# Perform global optimization
do_global_optimization(csv_path, cif_path)
```

The input CSV file should have a header with a "name" column. If a "labels" column is present, nodes will be grouped
accordingly in the output CIF file. Ensure that the node names in the CSV file match the node names in your CIF
specification.

For instance:

```csv
name,labels
a,block1
b,block1
c,block2
d,block2
e,block3
f,block3
```

This tool neither supports instantiations nor groups in the CIF plant model,
see [CIF to CIF transformer](https://www.eclipse.org/escet/cif/tools/cif2cif/) for information on how to eliminate them
as a preprocessing step.

Example CIF models and corresponding input files can be found in the tests/models directory of the repository. For more
advanced usage, see the test scripts provided in the repository.

For detailed information on the functions and their parameters, refer to the function documentation (docstrings) in the
source code.

## License

[MIT](LICENSE)
